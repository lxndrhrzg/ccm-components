ccm.component({name:"aherzo2s_comments",config:{html:[ccm.store,{local:"templates.json"}],key:"randomkey",store:[ccm.store,{url:"ws://ccm2.inf.h-brs.de/index.js",store:"aherzo2s_comments"}],style:[ccm.load,"ccm-style.css"],user:[ccm.instance,"http://kaul.inf.h-brs.de/ccm/components/user2.js"]},onsubmit:function(){var e=ccm.helper.val(ccm.helper.find(self,"input").val().trim());if(""!==e)return self.user.login(function(){dataset.messages.push({user:self.user.data().key,date:new Date,text:e}),self.store.set(dataset,function(){self.render()})}),!1},Instance:function(){var e=this;e.render=function(t){var s=ccm.helper.element(e);e.store.get(e.key,function(n){function c(n){s.html(ccm.helper.html(e.html.get("main")));for(var c=ccm.helper.find(e,".messages"),r=0;r<n.messages.length;r++){var a=n.messages[r];c.append(ccm.helper.html(e.html.get("message"),{name:ccm.helper.val(a.user),date:ccm.helper.val(a.date),text:ccm.helper.val(a.text)}))}s.append(ccm.helper.html(e.html.get("input"),{onsubmit:function(){var t=ccm.helper.val(ccm.helper.find(e,"textarea").val().trim());if(""!==t)return e.user.login(function(){n.messages.push({user:e.user.data().key,date:new Date,text:t}),e.store.set(n,function(){e.render()})}),!1}})),t&&t()}null===n?e.store.set({key:e.key,messages:[]},c):c(n)})},e.init=function(t){e.store.onChange=function(){e.render()},t()}}});